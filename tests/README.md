# Test Suite Documentation

This directory contains the automated test suite for the project, configured using Playwright.

## Setup Instructions

1.  **Install Dependencies:**
    Make sure you have Node.js (version specified in `.nvmrc`) installed. Then, install the project's dependencies:
    ```bash
    npm install # or pnpm install / yarn install
    ```
    This will install Playwright and other testing-related packages.

2.  **Environment Configuration:**
    Copy the `.env.example` file to `.env` in the project root and fill in the necessary environment variables, especially `BASE_URL` and `API_URL`.
    ```bash
    cp .env.example .env
    ```

## Running Tests

### Local Execution

To run all End-to-End tests locally:
```bash
npx playwright test
```

To run tests on a specific browser (e.g., Chromium):
```bash
npx playwright test --project=chromium
```

To run a specific test file:
```bash
npx playwright test tests/e2e/example.spec.ts
```

### Headed Mode (with UI)

To run tests with a browser UI visible:
```bash
npx playwright test --headed
```

### Debug Mode

Playwright's UI Mode allows you to run tests, see them execute in a browser, and debug step-by-step.
```bash
npx playwright test --ui
```

### Show HTML Report

After running tests, you can view a detailed HTML report:
```bash
npx playwright show-report
```

## Architecture Overview

### Fixture Pattern

We use Playwright's fixture system (`tests/support/fixtures/index.ts`) to manage test setup and teardown. This promotes test isolation and reusability. Fixtures ensure that each test runs in a clean, consistent environment.

### Data Factories

Data factories (`tests/support/fixtures/factories/user-factory.ts`) are used to create realistic test data for scenarios. They leverage `@faker-js/faker` to generate unique data on demand and include auto-cleanup logic to prevent test state pollution.

### Page Object Models (Optional)

For more complex applications, Page Object Models (`tests/support/page-objects/`) can be introduced to abstract page interactions, making tests more readable and maintainable.

## Best Practices

### Selector Strategy

We recommend using `data-testid` attributes on UI elements for reliable and resilient test selectors. Example: `<button data-testid="login-button">Login</button>`.

### Test Isolation & Cleanup

Tests are designed to be isolated, meaning they don't depend on the state left by previous tests. Fixtures include auto-cleanup logic to remove any created test data.

### Network-First Testing

Tests use network interception (`page.waitForResponse`) before navigating or performing actions to ensure determinism and prevent flakiness caused by asynchronous network calls.

## CI Integration

Tests are configured to run in Continuous Integration (CI) environments.
*   **Parallelism:** Tests run in parallel workers to speed up execution.
*   **Retries:** Flaky tests are retried automatically in CI.
*   **Artifacts:** Screenshots, videos, and traces are captured only on test failure to aid debugging without excessive storage.

## Knowledge Base References

This test framework incorporates best practices and patterns from the project's knowledge base:
*   [Fixture Architecture](.bmad/bmm/testarch/knowledge/fixture-architecture.md)
*   [Data Factories](.bmad/bmm/testarch/knowledge/data-factories.md)
*   [Network-First Safeguards](.bmad/bmm/testarch/knowledge/network-first.md)
*   [Test Quality Definition of Done](.bmad/bmm/testarch/knowledge/test-quality.md)

## Troubleshooting

*   **Test fails to run:** Ensure `BASE_URL` in your `.env` file points to a running instance of the application.
*   **Test fails unexpectedly:** Use Playwright's UI mode (`npx playwright test --ui`) or Trace Viewer (`npx playwright show-trace`) to debug.

---

_Generated by BMAD Master Test Architect (TEA) workflow._
_Date: {{date}}_
_For: {{user_name}}_
